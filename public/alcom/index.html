<!doctype html>

<head prefix="og: https://ogp.me/ns#">
<link rel="icon" type="application/svg" href="icon.svg">
<title>ALCOM</title>

<meta property="og:title" content="ALCOM - fast open-source VCC">
<meta property="og:type" content="website">
<meta property="og:url" content="https://vrc-get.anatawa12.com/alcom/">
<meta property="og:image" content="icon.svg">
<meta property="og:image" content="icon310x310.png">
<meta property="og:site_name" content="ALCOM">
<meta property="og:description" content="Download page of ALCOM">
<meta property="og:locale" content="en_US">
<meta property="og:locale:alternate" content="ja_JP">
</head>

<h1><img src="icon.svg" alt="icon of ALCOM" width="32" height="32"> ALCOM</h1>
<p>
    ALCOM is a fast open-source alternative of VRChat Creator Companion.
</p>

<p>
    ALCOM は高速なオープンソースの VRChat Creator Companion の代替ツールです。
</p>

<p class="loading">
    Loading the latest version... 最新版を取得中...
</p>

<div class="loaded" hidden>
    <p>
        Download the Latest Version: <button class="download-link">Download v<span class="version-name"></span> (<span class="platform"></span>)</button>
    </p>
    <p>
        最新版をダウンロード: <button class="download-link">Download v<span class="version-name"></span> (<span class="platform"></span>)</button>
    </p>

    <details>
        <summary>他のOS</summary>
        <ul>
            <li>macOS .dmg: <button class="download-link-macos">Download v<span class="version-name"></span></button></li>
            <li>Windows setup.exe: <button class="download-link-windows">Download v<span class="version-name"></span></button></li>
            <li>Linux AppImage: <button class="download-link-linux">Download v<span class="version-name"></span></button></li>
        </ul>
    </details>
</div>

<div class="failed" hidden>
    <p>Failed to load the latest version. 最新版の取得に失敗しました。</p>
    <p>Please try again later. 後でもう一度お試しください。</p>
</div>

<p>
    <a href="https://github.com/vrc-get/vrc-get/releases?q=gui-v0">Download other versions on the GitHub</a>
    <a href="https://github.com/vrc-get/vrc-get/releases?q=gui-v0">GitHub で他のバージョンをダウンロード</a>
</p>

<p>
    <a href="https://github.com/vrc-get/vrc-get/tree/master/vrc-get-gui">Source Code on GitHub</a>
</p>

<script>
  (async () => {
    try {
      const response = await fetch('https://vrc-get.anatawa12.com/api/gui/tauri-updater.json')
      const data = await response.json()
      const version = data.version;

      const macLink = `https://github.com/vrc-get/vrc-get/releases/download/gui-v${version}/ALCOM-${version}-universal.dmg`;
      const windowsLink = `https://github.com/vrc-get/vrc-get/releases/download/gui-v${version}/ALCOM-${version}-x86_64-setup.exe`;
      const linuxLink = `https://github.com/vrc-get/vrc-get/releases/download/gui-v${version}/alcom-${version}-x86_64.AppImage`;

      document.querySelectorAll('.version-name').forEach((el) => el.textContent = version);
      document.querySelector('.download-link-macos').addEventListener('click', () => window.location.href = macLink);
      document.querySelector('.download-link-windows').addEventListener('click', () => window.location.href = windowsLink);
      document.querySelector('.download-link-linux').addEventListener('click', () => window.location.href = linuxLink);

      switch (detectPlatform()) {
        case 'macOS':
          document.querySelectorAll('.platform').forEach((el) => el.textContent = 'macOS .dmg');
          document.querySelectorAll('.download-link').forEach((el) => el.addEventListener('click', () => window.location.href = macLink));
          break;
        default:
        case 'Windows':
          document.querySelectorAll('.platform').forEach((el) => el.textContent = 'Windows setup.exe');
          document.querySelectorAll('.download-link').forEach((el) => el.addEventListener('click', () => window.location.href = windowsLink));
          break;
        case 'Linux':
          document.querySelectorAll('.platform').forEach((el) => el.textContent = 'Linux AppImage');
          document.querySelectorAll('.download-link').forEach((el) => el.addEventListener('click', () => window.location.href = linuxLink));
          break;
      }

      document.querySelector('.loading').hidden = true
      document.querySelector('.loaded').hidden = false
    } catch (e) {
      document.querySelector('.loading').hidden = true
      document.querySelector('.failed').hidden = false
    }

    function detectPlatform() {
      const platform = window.navigator?.userAgentData?.platform || window.navigator.platform;

      if (platform.toLowerCase().indexOf('mac') !== -1) {
        return 'macOS';
      } else if (platform.toLowerCase().indexOf('win') !== -1) {
        return 'Windows';
      } else if (/Linux/.test(platform)) {
        return 'Linux';
      } else {
        return 'Windows';
      }
    }
  })()
</script>
